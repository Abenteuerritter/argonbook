{% extends "ArgonWebBundle::layout.html.twig" %}
{% trans_default_domain "ArgonWebBundle" %}
{% set active = "character" %}

{% block title %}{{ parent() }} - {{ "character.title"|trans }} - {{ character }} - {{ "character.skills"|trans }}{% endblock %}

{% block content %}
<h1>{{ "character.skills"|trans }}</h1>
{{ form_start(form) }}
  <div id="progress-experience">
    <div style="width: {{ ((character.skillsExperience * 100) / character.experience)|round }}%">
        <span class="sr-only">{{ character.skillsExperience }}</span>
    </div>
    <div style="width: 0%">
        <span class="sr-only">0</span>
    </div>
  </div>
  {{ form_widget(form.submit) }}
  <ul>
    <li><big id="experience-available">{{ character.availableExperience|default(0) }}</big> {{ "character_experience.stats.available"|trans }}</li>
    <li><big id="experience">{{ character.experience|default(0) }}</big> {{ "character_experience.stats.total"|trans }}</li>
  </ul>
  {{ form_errors(form) }}
  <table>
    <thead>
      <tr>
        <th>&nbsp;</th>
        <th>{{ "skill.name"|trans }}</th>
        <th>{{ "skill.level"|trans }}</th>
        <th>{{ "skill.price"|trans }}</th>
      </tr>
    </thead>
    <tbody>
    {% for characterSkill in form.characterSkills %}
    {% set skill = characterSkill.vars.value.skill %}
      <tr class="ability-{{ skill.abilityCode|default("all")|lower }}">
        <td>
          {% if skill.abilityCode %}
            <abbr title="{{ ("character_ability.types." ~ skill.abilityCode)|trans }} ({{ skill.abilityCode }})">*</abbr>
          {% else %}
            <abbr title="{{ "skill.ability_empty"|trans }}">*</abbr>
          {% endif %}
        </td>
        <td>{{ skill }}</td>
        <td>
          <div class="input-group">
            <span id="{{ skill.slug }}_level" class="input-group-addon level">{{ characterSkill.vars.value.level }}</span>
            {{
              form_widget(characterSkill.newLevel, {"attr": {
                "data-level" : characterSkill.vars.value.level|default(0),
                "data-max"   : skill.max|default(-1),
                "data-price" : characterSkill.vars.value.price
              }})
            }}
          </div>
          {{ form_errors(characterSkill.newLevel) }}
        </td>
        <td>{{ characterSkill.vars.value.price }}</td>
      </tr>
    {% else %}
      <tr class="warning">
        <td colspan="4">{{ "skill.empty"|trans }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
  {{ form_rest(form) }}
{{ form_end(form) }}
{% endblock %}